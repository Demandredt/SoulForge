@startuml
start
:用户上传文件;
:文件预处理组件;
if (文件类型?) then (图片)
  :图片处理管道;
  :格式转换;
  :生成缩略图;
else (文档)
  :文档解析管道;
  :提取元数据;
  :生成预览图;
endif
:分块上传模块;
:写入MinIO存储;
:记录元数据到MySQL;
:发送事件到Redis队列;
:WebSocket通知前端;
stop
@enduml